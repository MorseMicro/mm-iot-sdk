/*
 * Copyright 2024 Morse Micro
 *
 * SPDX-License-Identifier: Apache-2.0
 *
 * Warning: this file is autogenerated. Do not modify by hand.
 */

#pragma once

#include "mmconfig.h"

/* Maximum allowed length of any value string, needs to accomodate IP and MAC address strings */
#define MAX_VAL_LEN     32

void mmagic_core_wlan_load_all(struct mmagic_data *core)
{
    struct mmagic_wlan_data *data = &core->wlan_data;
    char val[MAX_VAL_LEN];
    if (mmconfig_read_string("wlan.ampdu_enabled", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.ampdu_enabled, val);
    }

    if (mmconfig_read_string("wlan.bssid", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_mac_addr(&data->config.bssid, val);
    }

    if (mmconfig_read_string("wlan.cac_enabled", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.cac_enabled, val);
    }

    if (mmconfig_read_string("wlan.country_code", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_country_code(&data->config.country_code, val);
    }

    if (mmconfig_read_string("wlan.fragment_threshold", val, sizeof(val)) > 0)
    {
        (void)string_to_uint32_t(&data->config.fragment_threshold, val);
    }

    if (mmconfig_read_string("wlan.max_health_check_intvl_ms", val, sizeof(val)) > 0)
    {
        (void)string_to_uint32_t(&data->config.max_health_check_intvl_ms, val);
    }

    if (mmconfig_read_string("wlan.min_health_check_intvl_ms", val, sizeof(val)) > 0)
    {
        (void)string_to_uint32_t(&data->config.min_health_check_intvl_ms, val);
    }

    if (mmconfig_read_string("wlan.offload_arp_refresh_s", val, sizeof(val)) > 0)
    {
        (void)string_to_uint32_t(&data->config.offload_arp_refresh_s, val);
    }

    if (mmconfig_read_string("wlan.offload_arp_response", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.offload_arp_response, val);
    }

    if (mmconfig_read_string("wlan.password", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_string_32(&data->config.password, val);
    }

    if (mmconfig_read_string("wlan.pmf_mode", val, sizeof(val)) > 0)
    {
        (void)string_to_enum_pmf_mode(&data->config.pmf_mode, val);
    }

    if (mmconfig_read_string("wlan.power_save_mode", val, sizeof(val)) > 0)
    {
        (void)string_to_enum_power_save_mode(&data->config.power_save_mode, val);
    }

    if (mmconfig_read_string("wlan.raw_priority", val, sizeof(val)) > 0)
    {
        (void)string_to_int16_t(&data->config.raw_priority, val);
    }

    if (mmconfig_read_string("wlan.rts_threshold", val, sizeof(val)) > 0)
    {
        (void)string_to_uint32_t(&data->config.rts_threshold, val);
    }

    if (mmconfig_read_string("wlan.security", val, sizeof(val)) > 0)
    {
        (void)string_to_enum_security_type(&data->config.security, val);
    }

    if (mmconfig_read_string("wlan.sgi_enabled", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.sgi_enabled, val);
    }

    if (mmconfig_read_string("wlan.ssid", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_string_32(&data->config.ssid, val);
    }

    if (mmconfig_read_string("wlan.station_type", val, sizeof(val)) > 0)
    {
        (void)string_to_enum_station_type(&data->config.station_type, val);
    }

    if (mmconfig_read_string("wlan.subbands_enabled", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.subbands_enabled, val);
    }

}

void mmagic_core_wlan_save_all(struct mmagic_data *core)
{
    struct mmagic_wlan_data *data = &core->wlan_data;
    char val[MAX_VAL_LEN];
    bool_to_string(&data->config.ampdu_enabled, val, sizeof(val));
    mmconfig_write_string("wlan.ampdu_enabled", val);

    struct_mac_addr_to_string(&data->config.bssid, val, sizeof(val));
    mmconfig_write_string("wlan.bssid", val);

    bool_to_string(&data->config.cac_enabled, val, sizeof(val));
    mmconfig_write_string("wlan.cac_enabled", val);

    struct_country_code_to_string(&data->config.country_code, val, sizeof(val));
    mmconfig_write_string("wlan.country_code", val);

    uint32_t_to_string(&data->config.fragment_threshold, val, sizeof(val));
    mmconfig_write_string("wlan.fragment_threshold", val);

    uint32_t_to_string(&data->config.max_health_check_intvl_ms, val, sizeof(val));
    mmconfig_write_string("wlan.max_health_check_intvl_ms", val);

    uint32_t_to_string(&data->config.min_health_check_intvl_ms, val, sizeof(val));
    mmconfig_write_string("wlan.min_health_check_intvl_ms", val);

    uint32_t_to_string(&data->config.offload_arp_refresh_s, val, sizeof(val));
    mmconfig_write_string("wlan.offload_arp_refresh_s", val);

    bool_to_string(&data->config.offload_arp_response, val, sizeof(val));
    mmconfig_write_string("wlan.offload_arp_response", val);

    struct_string_32_to_string(&data->config.password, val, sizeof(val));
    mmconfig_write_string("wlan.password", val);

    enum_pmf_mode_to_string(&data->config.pmf_mode, val, sizeof(val));
    mmconfig_write_string("wlan.pmf_mode", val);

    enum_power_save_mode_to_string(&data->config.power_save_mode, val, sizeof(val));
    mmconfig_write_string("wlan.power_save_mode", val);

    int16_t_to_string(&data->config.raw_priority, val, sizeof(val));
    mmconfig_write_string("wlan.raw_priority", val);

    uint32_t_to_string(&data->config.rts_threshold, val, sizeof(val));
    mmconfig_write_string("wlan.rts_threshold", val);

    enum_security_type_to_string(&data->config.security, val, sizeof(val));
    mmconfig_write_string("wlan.security", val);

    bool_to_string(&data->config.sgi_enabled, val, sizeof(val));
    mmconfig_write_string("wlan.sgi_enabled", val);

    struct_string_32_to_string(&data->config.ssid, val, sizeof(val));
    mmconfig_write_string("wlan.ssid", val);

    enum_station_type_to_string(&data->config.station_type, val, sizeof(val));
    mmconfig_write_string("wlan.station_type", val);

    bool_to_string(&data->config.subbands_enabled, val, sizeof(val));
    mmconfig_write_string("wlan.subbands_enabled", val);

}



static enum mmagic_status mmagic_core_event_wlan_beacon_rx(
        struct mmagic_data *core,
        const struct mmagic_core_event_wlan_beacon_rx_args *args)
{
    const uint8_t *payload = (const uint8_t *) args;
    size_t payload_len = sizeof(*args);
    MMOSAL_ASSERT(core->event_fn != NULL);
    return core->event_fn(
        core->event_fn_arg, mmagic_wlan,
        mmagic_wlan_event_beacon_rx, payload, payload_len);
}

static enum mmagic_status mmagic_core_event_wlan_standby_exit(
        struct mmagic_data *core,
        const struct mmagic_core_event_wlan_standby_exit_args *args)
{
    const uint8_t *payload = (const uint8_t *) args;
    size_t payload_len = sizeof(*args);
    MMOSAL_ASSERT(core->event_fn != NULL);
    return core->event_fn(
        core->event_fn_arg, mmagic_wlan,
        mmagic_wlan_event_standby_exit, payload, payload_len);
}

