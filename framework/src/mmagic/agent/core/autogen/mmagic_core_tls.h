/*
 * Copyright 2025 Morse Micro
 *
 * SPDX-License-Identifier: Apache-2.0
 *
 * Warning: this file is autogenerated. Do not modify by hand.
 */

#pragma once

#include "mmagic_core_types.h"

struct mmagic_data;

struct mmagic_tls_config
{
    /** Root certificate authority certificate. Supported formats are PEM and DER. Must
     * be null terminated if in PEM format. */
    struct raw1536 root_ca_certificate;
    /** Certificate to identify the client. Supported formats are PEM and DER. Must be
     * null terminated if in PEM format. */
    struct raw1536 client_certificate;
    /** Client private key. Supported formats are PEM and DER. Must be null terminated
     * if in PEM format. */
    struct raw1536 client_private_key;
};

struct mmagic_tls_data
{
    struct mmagic_tls_config config;
};

/**
 * Function to initialize the core data structure and register the ops functions.
 *
 * @param core Reference to to global mmagic context struct.
 */
void mmagic_core_tls_init(struct mmagic_data *core);

/**
 * Function to load settings from persistent store for the core tls subsystem.
 *
 * @param core Reference to to global mmagic context struct.
 */
void mmagic_core_tls_load_all(struct mmagic_data *core);

/**
 * Function to save settings to persistent store for the core tls subsystem.
 *
 * @param core Reference to to global mmagic context struct.
 */
void mmagic_core_tls_save_all(struct mmagic_data *core);

/**
 * Function to start any of the core processes for the core tls subsystem.
 *
 * @param core Reference to to global mmagic context struct.
 */
void mmagic_core_tls_start(struct mmagic_data *core);
