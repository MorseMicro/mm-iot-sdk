/*
 * Copyright 2024 Morse Micro
 *
 * SPDX-License-Identifier: Apache-2.0
 *
 * Warning: this file is autogenerated. Do not modify by hand.
 */

#pragma once

#include "mmconfig.h"

/* Maximum allowed length of any value string, needs to accomodate IP and MAC address strings */
#define MAX_VAL_LEN     32

void mmagic_core_ip_load_all(struct mmagic_data *core)
{
    struct mmagic_ip_data *data = &core->ip_data;
    char val[MAX_VAL_LEN];
    if (mmconfig_read_string("ip.dhcp_enabled", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.dhcp_enabled, val);
    }

    if (mmconfig_read_string("ip.dhcp_offload", val, sizeof(val)) > 0)
    {
        (void)string_to_bool(&data->config.dhcp_offload, val);
    }

    if (mmconfig_read_string("ip.dns_server0", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_ip_addr(&data->config.dns_server0, val);
    }

    if (mmconfig_read_string("ip.dns_server1", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_ip_addr(&data->config.dns_server1, val);
    }

    if (mmconfig_read_string("ip.gateway", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_ip_addr(&data->config.gateway, val);
    }

    if (mmconfig_read_string("ip.ip_addr", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_ip_addr(&data->config.ip_addr, val);
    }

    if (mmconfig_read_string("ip.netmask", val, sizeof(val)) > 0)
    {
        (void)string_to_struct_ip_addr(&data->config.netmask, val);
    }

}

void mmagic_core_ip_save_all(struct mmagic_data *core)
{
    struct mmagic_ip_data *data = &core->ip_data;
    char val[MAX_VAL_LEN];
    bool_to_string(&data->config.dhcp_enabled, val, sizeof(val));
    mmconfig_write_string("ip.dhcp_enabled", val);

    bool_to_string(&data->config.dhcp_offload, val, sizeof(val));
    mmconfig_write_string("ip.dhcp_offload", val);

    struct_ip_addr_to_string(&data->config.dns_server0, val, sizeof(val));
    mmconfig_write_string("ip.dns_server0", val);

    struct_ip_addr_to_string(&data->config.dns_server1, val, sizeof(val));
    mmconfig_write_string("ip.dns_server1", val);

    struct_ip_addr_to_string(&data->config.gateway, val, sizeof(val));
    mmconfig_write_string("ip.gateway", val);

    struct_ip_addr_to_string(&data->config.ip_addr, val, sizeof(val));
    mmconfig_write_string("ip.ip_addr", val);

    struct_ip_addr_to_string(&data->config.netmask, val, sizeof(val));
    mmconfig_write_string("ip.netmask", val);

}



