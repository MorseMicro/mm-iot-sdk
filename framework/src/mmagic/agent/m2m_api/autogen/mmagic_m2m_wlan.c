/*
 * Copyright 2025 Morse Micro
 *
 * SPDX-License-Identifier: Apache-2.0
 *
 * Warning: this file is autogenerated. Do not modify by hand.
 *
 * Note: The corresponding headers files must be included BEFORE this def file. Additionally this
 *       file should only be in one (and only one) compilation unit (.c/.cpp file).
 */

#include "mmconfig.h"
#include "mmutils.h"
#include "core/autogen/mmagic_core_wlan.h"
#include "core/autogen/mmagic_core_types.h"
#include "m2m_api/autogen/mmagic_m2m_wlan.h"
#include "m2m_api/autogen/mmagic_m2m_internal.h"
#include "m2m_api/mmagic_m2m_agent.h"

/* Maximum allowed length of any value string, needs to accomodate IP and MAC address strings */
#define MAX_VAL_LEN     32

/********* M2M Command Handlers **********/
static struct mmbuf *mmagic_m2m_wlan_get(struct mmagic_m2m_agent *agent,
                                         uint8_t sid, uint8_t subcommand,
                                         struct mmbuf *commandbuffer)
{
    MM_UNUSED(sid);
    MM_UNUSED(commandbuffer);

    struct mmagic_wlan_data *data = mmagic_data_get_wlan(&agent->core);
    switch (subcommand)
    {
    case mmagic_wlan_var_country_code:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.country_code,
                                          sizeof(data->config.country_code));

    case mmagic_wlan_var_ssid:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.ssid,
                                          sizeof(data->config.ssid));

    case mmagic_wlan_var_password:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.password,
                                          sizeof(data->config.password));

    case mmagic_wlan_var_security:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.security,
                                          sizeof(data->config.security));

    case mmagic_wlan_var_raw_priority:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.raw_priority,
                                          sizeof(data->config.raw_priority));

    case mmagic_wlan_var_bssid:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.bssid,
                                          sizeof(data->config.bssid));

    case mmagic_wlan_var_pmf_mode:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.pmf_mode,
                                          sizeof(data->config.pmf_mode));

    case mmagic_wlan_var_station_type:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.station_type,
                                          sizeof(data->config.station_type));

    case mmagic_wlan_var_rts_threshold:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.rts_threshold,
                                          sizeof(data->config.rts_threshold));

    case mmagic_wlan_var_sgi_enabled:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.sgi_enabled,
                                          sizeof(data->config.sgi_enabled));

    case mmagic_wlan_var_subbands_enabled:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.subbands_enabled,
                                          sizeof(data->config.subbands_enabled));

    case mmagic_wlan_var_ampdu_enabled:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.ampdu_enabled,
                                          sizeof(data->config.ampdu_enabled));

    case mmagic_wlan_var_power_save_mode:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.power_save_mode,
                                          sizeof(data->config.power_save_mode));

    case mmagic_wlan_var_fragment_threshold:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.fragment_threshold,
                                          sizeof(data->config.fragment_threshold));

    case mmagic_wlan_var_cac_enabled:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.cac_enabled,
                                          sizeof(data->config.cac_enabled));

    case mmagic_wlan_var_offload_arp_response:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.offload_arp_response,
                                          sizeof(data->config.offload_arp_response));

    case mmagic_wlan_var_offload_arp_refresh_s:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.offload_arp_refresh_s,
                                          sizeof(data->config.offload_arp_refresh_s));

    case mmagic_wlan_var_min_health_check_intvl_ms:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.min_health_check_intvl_ms,
                                          sizeof(data->config.min_health_check_intvl_ms));

    case mmagic_wlan_var_max_health_check_intvl_ms:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.max_health_check_intvl_ms,
                                          sizeof(data->config.max_health_check_intvl_ms));

    case mmagic_wlan_var_ndp_probe_enabled:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.ndp_probe_enabled,
                                          sizeof(data->config.ndp_probe_enabled));

    case mmagic_wlan_var_sta_scan_interval_base_s:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.sta_scan_interval_base_s,
                                          sizeof(data->config.sta_scan_interval_base_s));

    case mmagic_wlan_var_sta_scan_interval_limit_s:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.sta_scan_interval_limit_s,
                                          sizeof(data->config.sta_scan_interval_limit_s));

    case mmagic_wlan_var_qos_0_params:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.qos_0_params,
                                          sizeof(data->config.qos_0_params));

    case mmagic_wlan_var_qos_1_params:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.qos_1_params,
                                          sizeof(data->config.qos_1_params));

    case mmagic_wlan_var_qos_2_params:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.qos_2_params,
                                          sizeof(data->config.qos_2_params));

    case mmagic_wlan_var_qos_3_params:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.qos_3_params,
                                          sizeof(data->config.qos_3_params));

    case mmagic_wlan_var_mcs10_mode:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_OK, &data->config.mcs10_mode,
                                          sizeof(data->config.mcs10_mode));

    default:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get, subcommand,
                                          MMAGIC_STATUS_NOT_FOUND, NULL, 0);
    }
}

static struct mmbuf *mmagic_m2m_wlan_set(struct mmagic_m2m_agent *agent,
                                         uint8_t sid, uint8_t subcommand,
                                         struct mmbuf *commandbuffer)
{
    MM_UNUSED(sid);
    struct mmagic_wlan_data *data = mmagic_data_get_wlan(&agent->core);
    void *args = (void *)mmbuf_get_data_start(commandbuffer);
    switch (subcommand)
    {
    case mmagic_wlan_var_country_code:
        memcpy(&data->config.country_code, args, sizeof(data->config.country_code));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_ssid:
        memcpy(&data->config.ssid, args, sizeof(data->config.ssid));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_password:
        memcpy(&data->config.password, args, sizeof(data->config.password));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_security:
        memcpy(&data->config.security, args, sizeof(data->config.security));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_raw_priority:
        memcpy(&data->config.raw_priority, args, sizeof(data->config.raw_priority));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_bssid:
        memcpy(&data->config.bssid, args, sizeof(data->config.bssid));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_pmf_mode:
        memcpy(&data->config.pmf_mode, args, sizeof(data->config.pmf_mode));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_station_type:
        memcpy(&data->config.station_type, args, sizeof(data->config.station_type));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_rts_threshold:
        memcpy(&data->config.rts_threshold, args, sizeof(data->config.rts_threshold));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_sgi_enabled:
        memcpy(&data->config.sgi_enabled, args, sizeof(data->config.sgi_enabled));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_subbands_enabled:
        memcpy(&data->config.subbands_enabled, args, sizeof(data->config.subbands_enabled));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_ampdu_enabled:
        memcpy(&data->config.ampdu_enabled, args, sizeof(data->config.ampdu_enabled));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_power_save_mode:
        memcpy(&data->config.power_save_mode, args, sizeof(data->config.power_save_mode));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_fragment_threshold:
        memcpy(&data->config.fragment_threshold, args, sizeof(data->config.fragment_threshold));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_cac_enabled:
        memcpy(&data->config.cac_enabled, args, sizeof(data->config.cac_enabled));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_offload_arp_response:
        memcpy(&data->config.offload_arp_response, args, sizeof(data->config.offload_arp_response));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_offload_arp_refresh_s:
        memcpy(&data->config.offload_arp_refresh_s, args,
               sizeof(data->config.offload_arp_refresh_s));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_min_health_check_intvl_ms:
        memcpy(&data->config.min_health_check_intvl_ms, args,
               sizeof(data->config.min_health_check_intvl_ms));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_max_health_check_intvl_ms:
        memcpy(&data->config.max_health_check_intvl_ms, args,
               sizeof(data->config.max_health_check_intvl_ms));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_ndp_probe_enabled:
        memcpy(&data->config.ndp_probe_enabled, args, sizeof(data->config.ndp_probe_enabled));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_sta_scan_interval_base_s:
        memcpy(&data->config.sta_scan_interval_base_s, args,
               sizeof(data->config.sta_scan_interval_base_s));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_sta_scan_interval_limit_s:
        memcpy(&data->config.sta_scan_interval_limit_s, args,
               sizeof(data->config.sta_scan_interval_limit_s));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_qos_0_params:
        memcpy(&data->config.qos_0_params, args, sizeof(data->config.qos_0_params));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_qos_1_params:
        memcpy(&data->config.qos_1_params, args, sizeof(data->config.qos_1_params));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_qos_2_params:
        memcpy(&data->config.qos_2_params, args, sizeof(data->config.qos_2_params));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_qos_3_params:
        memcpy(&data->config.qos_3_params, args, sizeof(data->config.qos_3_params));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    case mmagic_wlan_var_mcs10_mode:
        memcpy(&data->config.mcs10_mode, args, sizeof(data->config.mcs10_mode));
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_OK, NULL, 0);
        break;

    default:
        return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_set,
                                          subcommand, MMAGIC_STATUS_NOT_FOUND, NULL, 0);
    }
}

static struct mmbuf *mmagic_m2m_wlan_load(struct mmagic_m2m_agent *agent,
                                          uint8_t sid, uint8_t subcommand,
                                          struct mmbuf *commandbuffer)
{
    MM_UNUSED(sid);
    MM_UNUSED(commandbuffer);

    mmagic_core_wlan_load_all(&agent->core);

    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_load,
                                      subcommand, MMAGIC_STATUS_OK, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_commit(struct mmagic_m2m_agent *agent,
                                            uint8_t sid, uint8_t subcommand,
                                            struct mmbuf *commandbuffer)
{
    MM_UNUSED(sid);
    MM_UNUSED(commandbuffer);

    mmagic_core_wlan_save_all(&agent->core);

    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_commit,
                                      subcommand, MMAGIC_STATUS_OK, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_connect(struct mmagic_m2m_agent *agent,
                                             uint8_t sid, uint8_t subcommand,
                                             struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_connect_cmd_args *cmd_args =
        (struct mmagic_core_wlan_connect_cmd_args *)mmbuf_get_data_start(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_connect(&agent->core, cmd_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_connect,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_disconnect(struct mmagic_m2m_agent *agent,
                                                uint8_t sid, uint8_t subcommand,
                                                struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    MM_UNUSED(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_disconnect(&agent->core);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_disconnect,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_scan(struct mmagic_m2m_agent *agent,
                                          uint8_t sid, uint8_t subcommand,
                                          struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_scan_cmd_args *cmd_args =
        (struct mmagic_core_wlan_scan_cmd_args *)mmbuf_get_data_start(commandbuffer);
    MM_UNUSED(sid);
    struct mmagic_core_wlan_scan_rsp_args rsp_args = { };
    status = mmagic_core_wlan_scan(&agent->core, cmd_args, &rsp_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_scan,
                                      subcommand, status, &rsp_args, sizeof(rsp_args));
}

static struct mmbuf *mmagic_m2m_wlan_get_rssi(struct mmagic_m2m_agent *agent,
                                              uint8_t sid, uint8_t subcommand,
                                              struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    MM_UNUSED(commandbuffer);
    MM_UNUSED(sid);
    struct mmagic_core_wlan_get_rssi_rsp_args rsp_args = { };
    status = mmagic_core_wlan_get_rssi(&agent->core, &rsp_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get_rssi,
                                      subcommand, status, &rsp_args, sizeof(rsp_args));
}

static struct mmbuf *mmagic_m2m_wlan_get_mac_addr(struct mmagic_m2m_agent *agent,
                                                  uint8_t sid, uint8_t subcommand,
                                                  struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    MM_UNUSED(commandbuffer);
    MM_UNUSED(sid);
    struct mmagic_core_wlan_get_mac_addr_rsp_args rsp_args = { };
    status = mmagic_core_wlan_get_mac_addr(&agent->core, &rsp_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_get_mac_addr,
                                      subcommand, status, &rsp_args, sizeof(rsp_args));
}

static struct mmbuf *mmagic_m2m_wlan_wnm_sleep(struct mmagic_m2m_agent *agent,
                                               uint8_t sid, uint8_t subcommand,
                                               struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_wnm_sleep_cmd_args *cmd_args =
        (struct mmagic_core_wlan_wnm_sleep_cmd_args *)mmbuf_get_data_start(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_wnm_sleep(&agent->core, cmd_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_wnm_sleep,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_beacon_monitor_enable(struct mmagic_m2m_agent *agent,
                                                           uint8_t sid, uint8_t subcommand,
                                                           struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_beacon_monitor_enable_cmd_args *cmd_args =
        (struct mmagic_core_wlan_beacon_monitor_enable_cmd_args *)mmbuf_get_data_start(
            commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_beacon_monitor_enable(&agent->core, cmd_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_beacon_monitor_enable,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_beacon_monitor_disable(struct mmagic_m2m_agent *agent,
                                                            uint8_t sid, uint8_t subcommand,
                                                            struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    MM_UNUSED(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_beacon_monitor_disable(&agent->core);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_beacon_monitor_disable,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_standby_enter(struct mmagic_m2m_agent *agent,
                                                   uint8_t sid, uint8_t subcommand,
                                                   struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    MM_UNUSED(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_standby_enter(&agent->core);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_standby_enter,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_standby_exit(struct mmagic_m2m_agent *agent,
                                                  uint8_t sid, uint8_t subcommand,
                                                  struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    MM_UNUSED(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_standby_exit(&agent->core);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_standby_exit,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_standby_set_status_payload(struct mmagic_m2m_agent *agent,
                                                                uint8_t sid, uint8_t subcommand,
                                                                struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_standby_set_status_payload_cmd_args *cmd_args =
        (struct mmagic_core_wlan_standby_set_status_payload_cmd_args *)mmbuf_get_data_start(
            commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_standby_set_status_payload(&agent->core, cmd_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_standby_set_status_payload,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_standby_set_wake_filter(struct mmagic_m2m_agent *agent,
                                                             uint8_t sid, uint8_t subcommand,
                                                             struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_standby_set_wake_filter_cmd_args *cmd_args =
        (struct mmagic_core_wlan_standby_set_wake_filter_cmd_args *)mmbuf_get_data_start(
            commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_standby_set_wake_filter(&agent->core, cmd_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_standby_set_wake_filter,
                                      subcommand, status, NULL, 0);
}

static struct mmbuf *mmagic_m2m_wlan_standby_set_config(struct mmagic_m2m_agent *agent,
                                                        uint8_t sid, uint8_t subcommand,
                                                        struct mmbuf *commandbuffer)
{
    enum mmagic_status status;
    struct mmagic_core_wlan_standby_set_config_cmd_args *cmd_args =
        (struct mmagic_core_wlan_standby_set_config_cmd_args *)mmbuf_get_data_start(commandbuffer);
    MM_UNUSED(sid);
    status = mmagic_core_wlan_standby_set_config(&agent->core, cmd_args);
    return mmagic_m2m_create_response(mmagic_wlan, mmagic_wlan_cmd_standby_set_config,
                                      subcommand, status, NULL, 0);
}

struct mmbuf *mmagic_m2m_wlan_process(struct mmagic_m2m_agent *agent, uint8_t sid,
                                      struct mmagic_m2m_command_header *header,
                                      struct mmbuf *cmd_buf)
{
    if (header)
    {
        switch (header->command)
        {
        case mmagic_wlan_cmd_get:
            return mmagic_m2m_wlan_get(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_set:
            return mmagic_m2m_wlan_set(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_load:
            return mmagic_m2m_wlan_load(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_commit:
            return mmagic_m2m_wlan_commit(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_connect:
            return mmagic_m2m_wlan_connect(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_disconnect:
            return mmagic_m2m_wlan_disconnect(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_scan:
            return mmagic_m2m_wlan_scan(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_get_rssi:
            return mmagic_m2m_wlan_get_rssi(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_get_mac_addr:
            return mmagic_m2m_wlan_get_mac_addr(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_wnm_sleep:
            return mmagic_m2m_wlan_wnm_sleep(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_beacon_monitor_enable:
            return mmagic_m2m_wlan_beacon_monitor_enable(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_beacon_monitor_disable:
            return mmagic_m2m_wlan_beacon_monitor_disable(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_standby_enter:
            return mmagic_m2m_wlan_standby_enter(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_standby_exit:
            return mmagic_m2m_wlan_standby_exit(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_standby_set_status_payload:
            return mmagic_m2m_wlan_standby_set_status_payload(agent, sid, header->subcommand,
                                                              cmd_buf);
            break;

        case mmagic_wlan_cmd_standby_set_wake_filter:
            return mmagic_m2m_wlan_standby_set_wake_filter(agent, sid, header->subcommand, cmd_buf);
            break;

        case mmagic_wlan_cmd_standby_set_config:
            return mmagic_m2m_wlan_standby_set_config(agent, sid, header->subcommand, cmd_buf);
            break;

        default:
            return mmagic_m2m_create_response(header->subsystem, header->command,
                                              header->subcommand, MMAGIC_STATUS_NOT_SUPPORTED, NULL,
                                              0);
        }
    }
    else
    {
        return mmagic_m2m_create_response(0, 0, 0, MMAGIC_STATUS_ERROR, NULL, 0);
    }
}
